try {
Import-Module WebAdministration -ErrorAction "Stop"
$Sites = Get-Website -ErrorAction "Stop"
$logdirectories = $sites | foreach-object {$_.logfile.directory -replace '%SystemDrive%',"$env:SystemDrive"} -ErrorAction "Stop"
}
Catch {
    $error[0].message
    Write-Output "`nTrying default log directory path C:\inetpub\logs\LogFiles"
    $logdirectories = 'C:\inetpub\logs\LogFiles'
}
Write-Output "Found log directories $($logdirectories)"
$logs = $logdirectories | foreach-object {Get-ChildItem -Path $_ -recurse | Where-Object {$_.extension -like '*.log'}}
$content = $logs | foreach-object {get-content -path $_.fullname}
$logmatch = $content | Select-String -Pattern 'powershell.*autodiscover\.json.*\@.*200'
if ($logmatch){$logmatch}
else {"No matches found"}
